{% load static %} {% load template_tags %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>article|{{ article.title_en }}</title>
    <link rel="shortcut icon" href="/media/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="{% static 'blog/css/swiper.min.css' %}">
    <link rel="stylesheet" href="{% static 'blog/css/bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'blog/fontawesome-free-5.15.3-web/css/all.css' %}">
    <link rel="stylesheet" href="{% static 'blog/css/custom.css' %}">
    <link rel="stylesheet" href="{% static 'blog/css/responsiv.css' %}">
    <link rel="stylesheet" href="{% static 'blog/css/pages/articels.css' %}">
</head>

<body>
    <div id="bg">
        <div id="bgItem" data-src="{{ article.thumbnail.url }}">

        </div>
    </div>
    <header class="thumbnail">
        <!-- navbar -->
        <nav id="navbar" class="navbar navbar-expand-sm navbar-light position-fixed w-100">
            <div class="container">
                <!-- logo nav -->
                <a class="navbar-brand" href="/">Django Website</a>
                <!-- logo nav end -->
                <button class="navbar-toggler" onclick="btnNavbar()" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="/articles">Articles</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/tags">Tags</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/creators">Creators</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- navbar end -->
        <div class="text-center header-img">
            <h1 class="w-100">
                {{ article.title_en }}
            </h1>
            <div class="w-auto px-0">
                <div class="py-2 d-inline-block">
                    <i class="fas fa-calendar"></i>
                    <span class="pe-2">
                        {{ article.simple_created }}
                    </span>
                </div>
                <div class="py-2 d-inline-block">
                    <i class="fas fa-eye"></i>
                    <span class="pe-2">
                        {{ article.views }}
                    </span>
                </div>
                <div class="py-2 d-inline-block">
                    <i class="fas fa-user"></i>
                    <a class="pe-2 text-dark text-decoration-none" href="/{{ article.author.username }}">
                        {% author_first_name article.author %}
                    </a>
                </div>
                <div class="py-2 d-inline-block">
                    <i class="fas fa-clock"></i>
                    <span class="pe-2">
                        {{ article.readtime }}min
                    </span>
                </div>
            </div>
        </div>
    </header>
    <main class="py-5">
        <div class="container">
            <div class="row gx-md-5">

                <!-- col Left -->
                <div class="col-md-8 col-lg-9">
                    <section>
                        <div class="row justify-content-center articel-header-img">
                            <div class="col-9 col-sm-7 text-center">
                                <img src="{{ article.thumbnail.url }}" class="img-fluid rounded shadow-lg rellax" data-rellax-speed="2" alt="">
                            </div>
                        </div>
                        <div class="row pt-5">
                            <!-- body Article -->
                            <div class="col-12">
                                {{ article.body_en|safe }}
                            </div>
                            <!-- body Article end -->
                        </div>
                    </section>

                    <!-- message box -->
                    <section class="bg-white shadow rounded mt-5 pb-1">
                        <div id="append-form">
                            <!-- form message -->
                            <form id="form-comment" method="POST">
                                {% csrf_token %}
                                <div class="form-row row justify-content-center p-3">
                                    <div class="col-12">

                                        <!-- name section in form -->
                                        <div class="my-2 align-items-end justify-content-between gy-3">
                                            <label for="title-message" class="form-label">Name</label> {{ comment_form.name }}
                                        </div>
                                        <!-- end name section -->

                                        <!-- avatar section in form -->
                                        <div class="my-2">
                                            <label for="avatar-message" class="form-label pt-2">Avatar*</label>
                                            <div id="avatar-message" class="w-100 px-3 form-control form-control-sm">
                                                <div class="mySwiper2 row overflow-hidden position-relative">
                                                    <div class="swiper-wrapper pt-2 pb-4">
                                                        {% for avatar in avatars %}
                                                        <div class="col-2 col-xl-1 swiper-slide">
                                                            <img src="{{ avatar.thumbnail.url }}" alt="avatar" data-avatar="{{ avatar.id }}" class="rounded-pill border border-secondary img-sm d-inline-block my-0 img-avatar" onclick="avatarSelect(this)">
                                                        </div>
                                                        {% endfor %}
                                                    </div>
                                                    <div class="swiper-pagination"></div>
                                                </div>
                                            </div>
                                            <input type="hidden" id="articel_input" name="articel_input">
                                            <!-- end avatar section -->

                                            <!-- massage section in form -->
                                            <div class="my-2">
                                                <label for="text-message" class="form-label pt-2">Comment</label> {{ comment_form.desc }}
                                            </div>
                                            <!-- end message section -->


                                            <!-- submit section in form -->
                                            <button name="submit-message" type="submit" class="btn btn-outline-dark btn-sm d-block mt-3 ms-auto">
                                                submit
                                            </button>
                                            <!-- end submit section -->
                                        </div>
                                    </div>
                                </div>
                            </form>
                            <!-- form message end -->
                        </div>
                        <div class="pt-2">
                            {% for comment in comments %}

                            <div class="px-3 py-1">
                                <div class="message p-3 pb-0 mb-2 rounded position-relative">
                                    <div class="d-flex align-items-center">
                                        {% if comment.avatar %}
                                        <img src="{{ comment.avatar.thumbnail.url }}" class="rounded-pill img-sm border border-secondary" alt="avatar"> {% else %}
                                        <img src="../media/avatars/default.png" class="rounded-pill img-sm border border-secondary" alt="avatar"> {% endif %}
                                        <div class="ps-3">
                                            <h6 class="my-1">
                                                {{ comment.name }}
                                            </h6>
                                            <p class="my-1">
                                                {{ comment.created }}
                                            </p>
                                        </div>
                                    </div>
                                    <p class=" pt-2 my-0 p-message">
                                        {{ comment.desc|safe }}
                                    </p>
                                    <div class="Paragraph-cover position-absolute d-none">
                                        <span class="badge bg-info float-end" onclick="showMoreMessage(this)">
                                                show more
                                        </span>
                                    </div>
                                    <div>
                                        <input type="hidden" name="parent_id" value="{{ comment.id }}">
                                    </div>
                                    <button class="pb-2 d-block btn ms-auto btn-sm text-decoration-none text-info" onclick="appendForm(this)">
                                            <i class="fas fa-reply"></i>
                                            replay
                                        </button>
                                    <div></div>

                                    {% for comment in comment.replies.all %} {% include 'partials/comment_loop.html' %} {% endfor %}

                                </div>
                            </div>
                            {% empty %}

                            <div class="px-5 py-5 text-center">
                                ...اولین نفری باشید که کامنت میگذارد
                            </div>
                            {% endfor %}

                        </div>

                    </section>
                    <!-- message box end -->
                </div>
                <!-- col Left end -->

                <!-- col Right -->
                {% include 'partials/col-4.html' %}
                <!-- col Right end -->
            </div>
        </div>
    </main>
    <!-- end main -->

    <!-- Footer -->
    <footer class="text-center bg-dark text-white" style='cursor: default;'>
        <!-- add class curosr default in the future -->
        <div class="text-center p-3">
            Created with
            <div class="position-relative d-inline-block w-auto h-auto" id="like_footer">
                <i class="far fa-heart"></i>
                <i class="fas fa-heart position-absolute"></i>
            </div>
            by
            <a class=" px-1 text-white" href="/alireza">Alireza</a> and
            <a class=" px-1 text-white" href="/amir">Amir</a>
        </div>
    </footer>
    <!-- Footer -->

    <!-- js refrences -->
    <script src="{% static 'blog/js/swiper-bundle.min.js' %}"></script>
    <script src="{% static 'blog/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'blog/js/rellax.min.js' %}"></script>
    <script src="{% static 'blog/js/index.js' %}"></script>
    <script>
        var rellax = new Rellax('.rellax');
    </script>
    <!-- end js refrences -->
</body>

</html>